<link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
{{ 'thumb-nav.css' | asset_url | stylesheet_tag }}

{% style %}
  /* 1. Base Variables & Defaults (Used when Custom Design is OFF) */
  :root {
    --thumb-font-family: var(--font-body-family, sans-serif);
    --thumb-bg-color: #ffffff;
    --thumb-text-active: #000000;
    --thumb-text-inactive: rgba(0, 0, 0, 0.5);
    --thumb-nav_opacity: 0.95;
    
    /* Icon & Layout Sizes (Always Active) */
    --thumb-icon-size: {{ block.settings.icon_size }}px;
    --thumb-text-size: {{ block.settings.text_size }}px;
    --thumb-spacing-bottom: {{ block.settings.spacing_bottom }}px;
    --thumb-menu-width: {{ block.settings.menu_width }}%;
    --thumb-desktop-max: {{ block.settings.desktop_width | default: 600 }}px;
    --thumb-scale: {{ block.settings.desktop_scale | default: 1.0 }};
    
    /* Ticker Colors (Always Active) */
    --thumb-ticker-bg: {{ block.settings.ticker_bg }};
    --thumb-ticker-text: {{ block.settings.ticker_text_color }};
  }

  /* 2. Custom Overrides (Only applied when Checkbox is ON) */
  {% if block.settings.enable_custom_design %}
    :root {
      /* Colors */
      {% if block.settings.inherit_theme_colors %}
        --thumb-bg-color: var(--gradient-background, var(--color-background, {{ block.settings.bg_color }}));
        --thumb-text-active: var(--color-foreground, var(--color-text, {{ block.settings.color_active }}));
        --thumb-text-inactive: color-mix(in srgb, var(--thumb-text-active), transparent 50%);
      {% else %}
        --thumb-bg-color: {{ block.settings.bg_color }};
        --thumb-text-active: {{ block.settings.color_active }};
        --thumb-text-inactive: {{ block.settings.color_active | color_modify: 'alpha', 0.5 }}; 
      {% endif %}

      {% if block.settings.color_inactive != blank %}
        --thumb-text-inactive: {{ block.settings.color_inactive }};
      {% endif %}

      /* Shape & Opacity */
      --thumb-radius: {{ block.settings.custom_radius }}px;
      --thumb-border-width: {{ block.settings.border_width }}px;
      --thumb-border-color: {{ block.settings.border_color }};
      --thumb-nav_opacity: {{ block.settings.nav_opacity | default: 90 | divided_by: 100.0 }};
    }

    /* Force Shape & Border Overrides */
    .thumb-zone-nav {
      border-radius: var(--thumb-radius) !important;
      border: var(--thumb-border-width) solid var(--thumb-border-color) !important;
    }
  {% endif %}

  /* 3. Base CSS Rules */
  .thumb-link .label {
    font-family: var(--thumb-font-family) !important;
    font-weight: 600; 
  }

  .thumb-wrapper.vertical-dock.is-dragging .drag-handle {
    transform: translateX(50%) scale(1.1) !important;
    width: 24px !important;
    height: 24px !important;
    border-radius: 50% !important;
  }

  .thumb-ticker {
    position: absolute;
    top: 0; left: 50%; transform: translateX(-50%);
    background: var(--thumb-ticker-bg); color: var(--thumb-ticker-text);
    padding: 6px 16px; border-radius: 20px; font-size: 11px; font-weight: 700;
    white-space: nowrap; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    z-index: -1; opacity: 0; pointer-events: none; text-decoration: none;
    transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }
  .thumb-ticker.is-visible { opacity: 1; top: -38px; pointer-events: auto; }
  .thumb-wrapper.vertical-dock .thumb-ticker { display: none !important; }

  /* Sticky ATC Button */
  .thumb-link.is-sticky-atc { background: transparent !important; border: none !important; }
  .thumb-link.is-sticky-atc .icon-box {
    background: var(--thumb-text-active) !important; color: var(--thumb-bg-color) !important;
    border: 3px solid var(--thumb-bg-color); border-radius: 50%;
    width: 50px !important; height: 50px !important; min-width: 50px !important; min-height: 50px !important;
    transform: scale(1.2); box-shadow: 0 8px 20px rgba(0,0,0,0.25);
    display: flex; flex-direction: column; align-items: center; justify-content: center; gap: 0px; 
    animation: thumb-pulse 2s infinite;
  }
  .thumb-wrapper.is-dragging .thumb-link.is-sticky-atc .icon-box { animation: none; }
  .thumb-link.is-sticky-atc i { font-size: 14px !important; line-height: 1; margin-bottom: 2px; display: block; }
  .thumb-link.is-sticky-atc .atc-text { 
    font-size: 8px; font-weight: 800; text-transform: uppercase; line-height: 0.9; letter-spacing: 0px;
    white-space: normal; text-align: center; width: 100%; max-width: 44px; word-wrap: break-word; display: block;
  }
  .thumb-link.is-sticky-atc .label { display: none !important; }
  @keyframes thumb-pulse {
    0% { transform: scale(1.35); box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.2); }
    70% { transform: scale(1.4); box-shadow: 0 0 0 10px rgba(0, 0, 0, 0); }
    100% { transform: scale(1.35); box-shadow: 0 0 0 0 rgba(0, 0, 0, 0); }
  }

  /* Recent Views Drawer */
  .thumb-recent-drawer {
    display: none; position: fixed; bottom: calc(var(--thumb-spacing-bottom) + 80px); left: 50%;
    transform: translateX(-50%) translateY(20px); width: 90%; max-width: 400px;
    background: var(--thumb-bg-color); border-radius: 16px; padding: 15px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.2); z-index: 2147483646; border: 1px solid rgba(0,0,0,0.05);
    gap: 10px; overflow-x: auto; scroll-snap-type: x mandatory; opacity: 0;
    transition: opacity 0.3s ease, transform 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }
  .thumb-recent-drawer.is-open { display: flex; opacity: 1; transform: translateX(-50%) translateY(0); }
  .recent-item { flex: 0 0 70px; scroll-snap-align: start; display: flex; flex-direction: column; align-items: center; text-decoration: none; color: var(--thumb-text-active); font-size: 10px; text-align: center; }
  .recent-item img { width: 50px; height: 50px; border-radius: 10px; object-fit: cover; margin-bottom: 5px; border: 1px solid rgba(0,0,0,0.1); }

  .thumb-wrapper.nav-hidden { opacity: 0 !important; pointer-events: none !important; }

  /* Desktop */
  @media screen and (min-width: 1025px) {
    .thumb-wrapper { max-width: var(--thumb-desktop-max) !important; transform: translateX(-50%) scale(var(--thumb-scale)); transform-origin: bottom center; }
    {% if block.settings.visibility_scope != 'all' %} .thumb-wrapper { display: none !important; } {% endif %}
  }
  @media screen and (min-width: 481px) and (max-width: 1024px) {
    {% if block.settings.visibility_scope == 'mobile' %} .thumb-wrapper { display: none !important; } {% endif %}
  }
{% endstyle %}

<div class="thumb-wrapper theme-{{ block.settings.theme_selection }} {% if block.settings.enable_spacer %}has-spacer{% endif %}">
  {% if block.settings.enable_ticker and block.settings.ticker_text != blank %}
    <a href="{{ block.settings.ticker_link | default: '#' }}" class="thumb-ticker" {% if block.settings.ticker_link == blank %}style="pointer-events: none;"{% endif %}>
      {{ block.settings.ticker_text }}
    </a>
  {% endif %}

  {% if block.settings.enable_draggable %}
    <div class="drag-handle" role="button" aria-label="Move navigation">
      <i class="ri-drag-move-2-fill"></i>
    </div>
  {% endif %}
  
  <div class="thumb-zone-nav">
    {%- assign main_menu = linklists[block.settings.menu_source].links -%}
    {%- assign icon_list = block.settings.icon_mapping | replace: ' ', '' | split: ',' -%}
    {%- assign label_list = block.settings.custom_labels | split: ',' -%}
    {%- assign url_list = block.settings.url_overrides | replace: ' ', '' | split: ',' -%}

    {%- if main_menu.size > 0 -%}
      {%- for link in main_menu limit: 5 -%}
        {%- assign index = forloop.index0 -%}
        {%- assign icon_name = icon_list[index] | default: 'link' | strip -%}
        {%- assign custom_label = label_list[index] | strip -%}
        {%- assign final_label = custom_label | default: link.title -%}
        {%- assign label_down = final_label | downcase -%}
        {%- assign final_url = url_list[index] | strip | default: link.url -%}
        
        {%- assign is_center_index = false -%}
        {%- if forloop.length == 5 and index == 2 -%}{%- assign is_center_index = true -%}{%- endif -%}
        {%- if forloop.length == 3 and index == 1 -%}{%- assign is_center_index = true -%}{%- endif -%}

        {%- assign show_sticky_atc = false -%}
        {%- if block.settings.enable_sticky_atc and request.page_type == 'product' and is_center_index -%}
          {%- assign show_sticky_atc = true -%}
        {%- endif -%}

        <a href="{{ final_url }}" 
           class="thumb-link {% if is_center_index %}hot-key-center{% endif %} {% if final_url == '/' and request.path == '/' %}active{% elsif final_url != '/' and request.path contains final_url %}active{% endif %} {% if show_sticky_atc %}is-sticky-atc{% endif %}"
           {% if show_sticky_atc %}
             data-thumb-action="add-to-cart"
           {% elsif label_down contains 'history' or label_down contains 'recent' %}
             data-thumb-action="history"
           {% elsif final_url contains '#' %}
             data-thumb-action="{{ final_url | remove: '#' }}"
           {% endif %}>
          <div class="icon-box">
            {% if show_sticky_atc %}
              <i class="ri-shopping-cart-2-fill"></i>
              <span class="atc-text">{{ block.settings.sticky_atc_label | default: "ADD +" }}</span>
            {% else %}
              <i class="ri-{{ icon_name }}{% unless icon_name contains '-line' or icon_name contains '-fill' %}-line{% endunless %}"></i>
              {%- if block.settings.show_cart_count and label_down contains 'cart' -%}
                  <span class="cart-badge">{{ cart.item_count }}</span>
              {%- endif -%}
            {% endif %}
          </div>
          {%- if block.settings.show_labels -%}
            <span class="label">
              {% if show_sticky_atc %}Buy{% else %}{{ final_label | truncate: 12, '..' }}{% endif %}
            </span>
          {%- endif -%}
        </a>
      {%- endfor -%}
    {%- endif -%}
  </div>
</div>

<div class="thumb-recent-drawer" id="thumb-recent-drawer"></div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const wrapper = document.querySelector('.thumb-wrapper');
    const spacerEnabled = {{ block.settings.enable_spacer | json }};
    const dragEnabled = {{ block.settings.enable_draggable | json }};
    const tickerTrigger = "{{ block.settings.ticker_trigger }}";
    const STORAGE_KEY = 'thumb-zone-nav-position';

    if (!wrapper) return;

    // 0. HISTORY LOGIC
    {% if request.page_type == 'product' %}
      try {
        const historyKey = 'thumb-recent-views';
        const currentProduct = {
          id: {{ product.id }},
          title: "{{ product.title | escape }}",
          url: "{{ product.url }}",
          img: "{{ product.featured_image | image_url: width: 100 }}"
        };
        let history = JSON.parse(localStorage.getItem(historyKey) || '[]');
        history = history.filter(p => p.id !== currentProduct.id);
        history.unshift(currentProduct);
        if (history.length > 6) history.pop();
        localStorage.setItem(historyKey, JSON.stringify(history));
      } catch(e) {}
    {% endif %}

    // 1. TICKER LOGIC
    const ticker = document.querySelector('.thumb-ticker');
    if (ticker) {
      let shouldShow = false;
      const hasVisited = localStorage.getItem('thumb-ticker-seen');
      
      if (tickerTrigger === 'always') shouldShow = true;
      else if (tickerTrigger === 'first_visit' && !hasVisited) {
        shouldShow = true; localStorage.setItem('thumb-ticker-seen', 'true');
      } else if (tickerTrigger === 'cart_has_items' && {{ cart.item_count }} > 0) {
        shouldShow = true;
      }

      if (shouldShow) setTimeout(() => ticker.classList.add('is-visible'), 1500); 
    }

    // 2. ACTIONS & DRAWER
    const recentDrawer = document.getElementById('thumb-recent-drawer');
    
    function toggleRecentDrawer() {
      if(recentDrawer.classList.contains('is-open')) {
        recentDrawer.classList.remove('is-open');
        wrapper.classList.remove('nav-hidden'); // Show nav when internal drawer closes
        setTimeout(() => { recentDrawer.style.display = 'none'; }, 300);
        return;
      }
      
      const history = JSON.parse(localStorage.getItem('thumb-recent-views') || '[]');
      
      if(history.length === 0) {
        recentDrawer.innerHTML = '<div style="padding:10px; opacity:0.6; font-size:12px;">No recently viewed products.</div>';
      } else {
        recentDrawer.innerHTML = history.map(p => 
          `<a href="${p.url}" class="recent-item">
             <img src="${p.img}" alt="${p.title}" />
             <span>${p.title.substring(0, 10)}..</span>
           </a>`
        ).join('');
      }
      
      recentDrawer.style.display = 'flex';
      setTimeout(() => {
        recentDrawer.classList.add('is-open');
        wrapper.classList.add('nav-hidden'); // Hide nav when internal drawer opens
      }, 10);

      document.addEventListener('click', function close(e) {
        if(!recentDrawer.contains(e.target) && !e.target.closest('[data-thumb-action="history"]')) {
          recentDrawer.classList.remove('is-open');
          wrapper.classList.remove('nav-hidden'); 
          setTimeout(() => { recentDrawer.style.display = 'none'; }, 300);
          document.removeEventListener('click', close);
        }
      });
    }

    function triggerAddToCart() {
      const mainBtn = document.querySelector('form[action*="/cart/add"] button[type="submit"], .product-form__submit, [name="add"]');
      if(mainBtn) { mainBtn.click(); triggerHaptic(); return; }
      
      {% if product.selected_or_first_available_variant %}
      const formData = new FormData();
      formData.append('id', {{ product.selected_or_first_available_variant.id }});
      formData.append('quantity', 1);
      fetch(window.Shopify.routes.root + 'cart/add.js', { method: 'POST', body: formData })
      .then(r => r.json()).then(() => {
        updateCartBadges();
        const cartIcon = document.querySelector('.header__icon--cart, #cart-icon-bubble');
        if(cartIcon) cartIcon.click();
      }).catch(e => console.error(e));
      {% endif %}
    }

    // 3. DRAG (Fixed)
    if (dragEnabled) {
      const handle = wrapper.querySelector('.drag-handle');
      if (handle) {
        const savedState = localStorage.getItem(STORAGE_KEY);
        if (savedState) {
          try {
            const state = JSON.parse(savedState);
            if (state.mode !== 'bottom') {
              wrapper.classList.add('vertical-dock');
              wrapper.style.bottom = 'auto';
              wrapper.style.transform = 'translateY(-50%)';
              wrapper.style.top = state.top;
              wrapper.style.width = '60px';
              if (state.mode === 'left') { wrapper.style.left = '10px'; wrapper.style.right = 'auto'; }
              else { wrapper.style.left = 'auto'; wrapper.style.right = '10px'; }
            }
          } catch (e) {}
        }

        let isDragging = false, offset = {x:0, y:0};
        handle.style.touchAction = 'none'; handle.style.cursor = 'grab';

        const onStart = (e) => {
          if (e.cancelable) e.preventDefault(); e.stopPropagation();
          wrapper.style.transition = 'none'; 
          const clientX = e.touches ? e.touches[0].clientX : e.clientX;
          const clientY = e.touches ? e.touches[0].clientY : e.clientY;
          const rect = wrapper.getBoundingClientRect();
          offset.x = clientX - rect.left; offset.y = clientY - rect.top;
          
          isDragging = true; wrapper.classList.add('is-dragging'); handle.style.cursor = 'grabbing';
          wrapper.style.bottom = 'auto'; wrapper.style.right = 'auto'; wrapper.style.transform = 'none'; wrapper.style.margin = '0';
          wrapper.style.width = rect.width + 'px'; wrapper.style.left = rect.left + 'px'; wrapper.style.top = rect.top + 'px';
          triggerHaptic();
        };

        const onMove = (e) => {
          if (!isDragging) return; if (e.cancelable) e.preventDefault(); 
          const clientX = e.touches ? e.touches[0].clientX : e.clientX;
          const clientY = e.touches ? e.touches[0].clientY : e.clientY;
          wrapper.style.left = (clientX - offset.x) + 'px'; wrapper.style.top = (clientY - offset.y) + 'px';
        };

        const onEnd = () => {
          if (!isDragging) return;
          isDragging = false; wrapper.classList.remove('is-dragging'); handle.style.cursor = 'grab'; wrapper.style.transition = ''; 
          const rect = wrapper.getBoundingClientRect();
          const distToBottom = window.innerHeight - rect.bottom;
          if (distToBottom < 150) {
            wrapper.classList.remove('vertical-dock');
            wrapper.style.top = 'auto'; wrapper.style.bottom = 'calc(var(--thumb-spacing-bottom, 20px) + env(safe-area-inset-bottom, 0px))';
            wrapper.style.left = '50%'; wrapper.style.transform = 'translateX(-50%)'; wrapper.style.width = 'var(--thumb-menu-width, 95%)'; wrapper.style.right = 'auto';
            if(spacerEnabled) adjustBodyPadding();
            localStorage.setItem(STORAGE_KEY, JSON.stringify({ mode: 'bottom' }));
          } else {
            wrapper.classList.add('vertical-dock');
            wrapper.style.bottom = 'auto'; wrapper.style.transform = 'translateY(-50%)';
            const newTop = (rect.top + (rect.height / 2)) + 'px'; wrapper.style.top = newTop; wrapper.style.width = '60px';
            let savedMode = (rect.left < window.innerWidth / 2) ? 'left' : 'right';
            if (savedMode === 'left') { wrapper.style.left = '10px'; wrapper.style.right = 'auto'; } else { wrapper.style.left = 'auto'; wrapper.style.right = '10px'; }
            document.body.style.paddingBottom = '0px';
            localStorage.setItem(STORAGE_KEY, JSON.stringify({ mode: savedMode, top: newTop }));
          }
        };
        handle.addEventListener('touchstart', onStart, {passive: false}); handle.addEventListener('mousedown', onStart);
        document.addEventListener('touchmove', onMove, {passive: false}); document.addEventListener('mousemove', onMove);
        document.addEventListener('touchend', onEnd); document.addEventListener('mouseup', onEnd);
      }
    }

    // 4. UTILS
    function adjustBodyPadding() {
      if (spacerEnabled && !wrapper.classList.contains('vertical-dock')) {
        const height = wrapper.offsetHeight; const spacing = parseInt(getComputedStyle(document.documentElement).getPropertyValue('--thumb-spacing-bottom')) || 20;
        document.body.style.paddingBottom = (height + spacing) + 'px';
      } else { document.body.style.paddingBottom = '0px'; }
    }
    adjustBodyPadding(); window.addEventListener('resize', adjustBodyPadding);

    function triggerHaptic() { if ("vibrate" in navigator && window.matchMedia("(pointer: coarse)").matches) navigator.vibrate(10); }

    function updateCartBadges() {
      fetch(`${window.Shopify.routes.root}cart.js`).then(r => r.json()).then(c => {
        document.querySelectorAll('.cart-badge').forEach(b => { b.textContent = c.item_count; b.style.display = c.item_count > 0 ? 'flex' : 'none'; });
        if (tickerTrigger === 'cart_has_items' && ticker) {
           if (c.item_count > 0) ticker.classList.add('is-visible'); else ticker.classList.remove('is-visible');
        }
      }).catch(e => {});
    }
    document.addEventListener('change', updateCartBadges); updateCartBadges();

    const triggerUniversalAction = (type) => {
      const customSearch = "{{ block.settings.custom_search_selector }}";
      const customMenu = "{{ block.settings.custom_menu_selector }}";
      let selectors = [];
      if (type === 'search') selectors = [customSearch, '.header__search-toggle', 'details-modal summary', '.header__icon--search', '[href="/search"]'];
      if (type === 'menu') selectors = [customMenu, '[data-action="open-drawer"]', 'summary.header__icon--menu', '.header__icon--menu'];
      if (type === 'cart') selectors = ['#cart-icon-bubble', '[aria-controls="CartDrawer"]', '.header__icon--cart'];
      const el = selectors.find(s => s && document.querySelector(s));
      if (el) { document.querySelector(el).click(); return true; }
      if (type === 'search') window.location.href = '/search';
      if (type === 'menu') window.location.href = '/collections/all';
      if (type === 'cart') window.location.href = '/cart';
    };

    document.querySelectorAll('.thumb-link').forEach(link => {
      link.addEventListener('click', function(e) {
        const action = this.getAttribute('data-thumb-action');
        if (action) {
          e.preventDefault();
          if(action === 'add-to-cart') triggerAddToCart();
          else if(action === 'history') toggleRecentDrawer();
          else if(['search','menu','cart'].includes(action)) triggerUniversalAction(action);
          else if(action === 'top') window.scrollTo({ top: 0, behavior: 'smooth' });
          else if(action === 'back') window.history.back();
          else if(action === 'share' && navigator.share) navigator.share({ title: document.title, url: window.location.href });
        }
        triggerHaptic();
      });
    });

    // 5. OBSERVER FOR EXTERNAL MENUS (Updated for better compatibility)
    function initExternalDrawerObserver() {
      const checkDrawerState = () => {
        // A. Check Computed Style (most robust): checks if scrolling is locked on body OR html
        const bodyOverflow = window.getComputedStyle(document.body).overflow;
        const htmlOverflow = window.getComputedStyle(document.documentElement).overflow;
        const isScrollLocked = bodyOverflow === 'hidden' || htmlOverflow === 'hidden';

        // B. Check for known Class Names (Dawn, Prestige, etc.)
        const hasLockClass = document.body.classList.contains('overflow-hidden') || 
                             document.documentElement.classList.contains('overflow-hidden') ||
                             document.body.classList.contains('js-drawer-open');

        // C. Check for standard 'details' menu element being open
        const isDetailsOpen = document.querySelector('details.menu-drawer-container[open], details[open] > .menu-drawer');

        // D. Check internal drawer
        const isInternalOpen = recentDrawer.classList.contains('is-open');

        if (isScrollLocked || hasLockClass || isDetailsOpen || isInternalOpen) {
          wrapper.classList.add('nav-hidden');
        } else {
          wrapper.classList.remove('nav-hidden');
        }
      };

      // 1. Observer: Watch Body & HTML for class/style changes
      const observer = new MutationObserver(checkDrawerState);
      observer.observe(document.body, { attributes: true, attributeFilter: ['class', 'style'] });
      observer.observe(document.documentElement, { attributes: true, attributeFilter: ['class', 'style'] });

      // 2. Observer: Watch all <details> elements for the 'open' attribute
      document.querySelectorAll('details').forEach(el => {
         new MutationObserver(checkDrawerState).observe(el, { attributes: true, attributeFilter: ['open'] });
      });

      // 3. Fallback: Check every 500ms (Catches edge cases where observers miss)
      setInterval(checkDrawerState, 500);
      
      // Initial run
      checkDrawerState();
    }
    initExternalDrawerObserver();

  });
</script>

{% schema %}
{
  "name": "Thumb-Zone Menu Pro",
  "target": "body",
  "settings": [
    {
      "type": "header",
      "content": "CONVERSION BOOSTERS"
    },
    {
      "type": "checkbox",
      "id": "enable_sticky_atc",
      "label": "Enable Sticky Add-to-Cart",
      "default": true,
      "info": "On Product Pages, the center icon transforms into a Buy button."
    },
    {
      "type": "text",
      "id": "sticky_atc_label",
      "label": "Button Label",
      "default": "ADD TO CART "
    },
    {
      "type": "header",
      "content": "ANNOUNCEMENT TICKER"
    },
    {
      "type": "checkbox",
      "id": "enable_ticker",
      "label": "Enable Floating Ticker",
      "default": false
    },
    {
      "type": "text",
      "id": "ticker_text",
      "label": "Ticker Message",
      "default": "âš¡ Free Shipping over $50"
    },
    {
      "type": "url",
      "id": "ticker_link",
      "label": "Ticker Link (Optional)"
    },
    {
      "type": "select",
      "id": "ticker_trigger",
      "label": "Show Ticker When...",
      "options": [
        { "value": "always", "label": "Always" },
        { "value": "first_visit", "label": "First Visit Only (Once per user)" },
        { "value": "cart_has_items", "label": "Cart has items" }
      ],
      "default": "always"
    },
    {
      "type": "color",
      "id": "ticker_bg",
      "label": "Ticker Background",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "ticker_text_color",
      "label": "Ticker Text",
      "default": "#ffffff"
    },
   {
      "type": "header",
      "content": "Theme & Colors"
    },
    {
      "type": "checkbox",
      "id": "inherit_theme_colors",
      "label": "Inherit Theme Colors",
      "default": false,
      "info": "Automatically match your store's theme."
    },
    {
      "type": "checkbox",
      "id": "enable_custom_design",
      "label": "Enable Custom Colors & Shape",
      "default": false,
      "info": "Uncheck this to RESET to the selected Theme's default look."
    },
    {
      "type": "color",
      "id": "bg_color",
      "label": "Custom Background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "color_active",
      "label": "Active Icon Color",
      "default": "#000000"
    },
    {
      "type": "color",
      "id": "color_inactive",
      "label": "Inactive Icon Color",
      "info": "Optional. Overrides the auto-faded color."
    },
    {
      "type": "range",
      "id": "nav_opacity",
      "min": 0,
      "max": 100,
      "step": 5,
      "unit": "%",
      "label": "Opacity",
      "default": 90
    },
    {
      "type": "range",
      "id": "custom_radius",
      "min": 0,
      "max": 50,
      "step": 2,
      "unit": "px",
      "label": "Corner Radius",
      "default": 24,
      "info": "0 = Square, 50 = Round/Pill."
    },
    {
      "type": "range",
      "id": "border_width",
      "min": 0,
      "max": 5,
      "step": 1,
      "unit": "px",
      "label": "Border Width",
      "default": 0
    },
    {
      "type": "color",
      "id": "border_color",
      "label": "Border Color",
      "default": "transparent"
    },
    

    {
      "type": "select",
      "id": "theme_selection",
      "label": "Design Theme",
      "options": [
        { "group": "1. Standard", "value": "ios", "label": "iOS Glass" },
        { "group": "1. Standard", "value": "midnight", "label": "Midnight Capsule" },
        { "group": "1. Standard", "value": "action", "label": "Split Action" },
        { "group": "1. Standard", "value": "text-only", "label": "Text Only" },
        { "group": "1. Standard", "value": "material", "label": "Material Design" },
        { "group": "1. Standard", "value": "flat", "label": "Flat & Clean" },
        
        { "group": "2. Modern UI", "value": "island", "label": "Dynamic Island" },
        { "group": "2. Modern UI", "value": "float", "label": "Levitate (Floating)" },
        { "group": "2. Modern UI", "value": "neumorphic", "label": "Neumorphic Light" },
        { "group": "2. Modern UI", "value": "neumorphic-dark", "label": "Neumorphic Dark" },
        { "group": "2. Modern UI", "value": "glass-morphism", "label": "Full Glassmorphism" },
        { "group": "2. Modern UI", "value": "brutal", "label": "Brutalist Bold" },
        { "group": "2. Modern UI", "value": "bauhaus", "label": "Bauhaus Geometric" },
        { "group": "2. Modern UI", "value": "outline", "label": "Wireframe Outline" },
        { "group": "2. Modern UI", "value": "pill", "label": "The Pill" },
        { "group": "2. Modern UI", "value": "notch", "label": "Phone Notch" },

        { "group": "3. Gradients", "value": "flash-sale", "label": "Flash Sale (Red/Orange)" },
        { "group": "3. Gradients", "value": "solar", "label": "Solar Flare (Pink/Orange)" },
        { "group": "3. Gradients", "value": "ocean", "label": "Deep Ocean (Blue/Teal)" },
        { "group": "3. Gradients", "value": "berry", "label": "Berry Smoothie (Purple/Pink)" },
        { "group": "3. Gradients", "value": "aurora", "label": "Aurora Borealis (Green/Blue)" },
        { "group": "3. Gradients", "value": "sunset", "label": "Sunset Blvd (Yellow/Red)" },
        { "group": "3. Gradients", "value": "minty", "label": "Fresh Mint (Green/Cyan)" },
        { "group": "3. Gradients", "value": "royal", "label": "Royal Gold (Gold/Black)" },
        { "group": "3. Gradients", "value": "disco", "label": "Disco Fever (Multi)" },
        { "group": "3. Gradients", "value": "chrome", "label": "Liquid Chrome" },

        { "group": "4. Dark & Moody", "value": "dark-pro", "label": "Dark Mode Pro" },
        { "group": "4. Dark & Moody", "value": "gothic", "label": "Gothic Dark" },
        { "group": "4. Dark & Moody", "value": "abyss", "label": "The Abyss (Vantablack)" },
        { "group": "4. Dark & Moody", "value": "vampire", "label": "Vampire (Black/Red)" },
        { "group": "4. Dark & Moody", "value": "obsidian", "label": "Obsidian Gloss" },
        { "group": "4. Dark & Moody", "value": "stealth", "label": "Stealth Matte" },
        { "group": "4. Dark & Moody", "value": "carbon", "label": "Carbon Fiber" },
        { "group": "4. Dark & Moody", "value": "night-sky", "label": "Starry Night" },

        { "group": "5. Retro & Nostalgia", "value": "pixel", "label": "Retro Pixel (8-Bit)" },
        { "group": "5. Retro & Nostalgia", "value": "vapor", "label": "Vaporwave" },
        { "group": "5. Retro & Nostalgia", "value": "terminal", "label": "Hacker Terminal" },
        { "group": "5. Retro & Nostalgia", "value": "gameboy", "label": "Handheld Console" },
        { "group": "5. Retro & Nostalgia", "value": "vhs", "label": "VHS Glitch" },
        { "group": "5. Retro & Nostalgia", "value": "pop-art", "label": "Pop Art" },
        { "group": "5. Retro & Nostalgia", "value": "groove", "label": "70s Groove" },
        { "group": "5. Retro & Nostalgia", "value": "diner", "label": "50s Diner" },
        { "group": "5. Retro & Nostalgia", "value": "blueprint", "label": "Blueprint" },
        
        { "group": "6. Futuristic", "value": "cyber", "label": "Cyberpunk Neon" },
        { "group": "6. Futuristic", "value": "space", "label": "Deep Space" },
        { "group": "6. Futuristic", "value": "matrix", "label": "The Matrix" },
        { "group": "6. Futuristic", "value": "holo", "label": "Holographic" },
        { "group": "6. Futuristic", "value": "scifi", "label": "Sci-Fi HUD" },
        { "group": "6. Futuristic", "value": "robot", "label": "White Robot" },
        { "group": "6. Futuristic", "value": "laser", "label": "Laser Grid" },

        { "group": "7. Textures & Materials", "value": "clay", "label": "Claymorphism" },
        { "group": "7. Textures & Materials", "value": "paper", "label": "Vintage Paper" },
        { "group": "7. Textures & Materials", "value": "wood", "label": "Wood Grain" },
        { "group": "7. Textures & Materials", "value": "denim", "label": "Blue Denim" },
        { "group": "7. Textures & Materials", "value": "leather", "label": "Brown Leather" },
        { "group": "7. Textures & Materials", "value": "marble", "label": "White Marble" },
        { "group": "7. Textures & Materials", "value": "gold-bar", "label": "Solid Gold" },
        { "group": "7. Textures & Materials", "value": "concrete", "label": "Urban Concrete" },
        { "group": "7. Textures & Materials", "value": "ice", "label": "Frosted Ice" },
        { "group": "7. Textures & Materials", "value": "water", "label": "Water Droplet" },

        { "group": "8. Creative Arts", "value": "sketch", "label": "Hand Drawn Sketch" },
        { "group": "8. Creative Arts", "value": "sticker", "label": "Sticker Bomb" },
        { "group": "8. Creative Arts", "value": "paint", "label": "Paint Splatter" },
        { "group": "8. Creative Arts", "value": "watercolor", "label": "Watercolor" },
        { "group": "8. Creative Arts", "value": "origami", "label": "Origami Fold" },
        { "group": "8. Creative Arts", "value": "collage", "label": "Magazine Collage" },
        { "group": "8. Creative Arts", "value": "marker", "label": "Permanent Marker" },

        { "group": "9. Fun & Playful", "value": "candy", "label": "Candy Shop" },
        { "group": "9. Fun & Playful", "value": "bubble-tea", "label": "Bubble Tea" },
        { "group": "9. Fun & Playful", "value": "lego", "label": "Building Blocks" },
        { "group": "9. Fun & Playful", "value": "donut", "label": "Sprinkled Donut" },
        { "group": "9. Fun & Playful", "value": "slime", "label": "Green Slime" },
        { "group": "9. Fun & Playful", "value": "emoji", "label": "Emoji Yellow" },
        { "group": "9. Fun & Playful", "value": "cloud", "label": "Fluffy Cloud" },
        { "group": "9. Fun & Playful", "value": "unicorn", "label": "Unicorn Magic" },

        { "group": "10. Minimalist", "value": "monolith", "label": "Monolith" },
        { "group": "10. Minimalist", "value": "min-dot", "label": "Minimalist Dot" },
        { "group": "10. Minimalist", "value": "ghost", "label": "Ghost (Transparent)" },
        { "group": "10. Minimalist", "value": "line", "label": "Thin Line" },
        { "group": "10. Minimalist", "value": "underline", "label": "Underline Only" },
        { "group": "10. Minimalist", "value": "overline", "label": "Overline Only" },
        { "group": "10. Minimalist", "value": "dots", "label": "Dots Only" },
        { "group": "10. Minimalist", "value": "boxed", "label": "Wireframe Box" },
        { "group": "10. Minimalist", "value": "pearl", "label": "Floating Pearl" },
        { "group": "10. Minimalist", "value": "soft-pop", "label": "Soft Pop" },

        { "group": "11. Atmosphere", "value": "nature", "label": "Organic Nature" },
        { "group": "11. Atmosphere", "value": "luxury", "label": "Gold Luxury" },
        { "group": "11. Atmosphere", "value": "eco", "label": "Eco Friendly" },
        { "group": "11. Atmosphere", "value": "desert", "label": "Desert Sand" },
        { "group": "11. Atmosphere", "value": "forest", "label": "Dark Forest" },
        { "group": "11. Atmosphere", "value": "fire", "label": "Fire & Ash" },

        { "group": "12. Seasonal", "value": "xmas", "label": "Christmas Red" },
        { "group": "12. Seasonal", "value": "halloween", "label": "Halloween Spooky" },
        { "group": "12. Seasonal", "value": "valentine", "label": "Valentine Hearts" },
        { "group": "12. Seasonal", "value": "spring", "label": "Spring Bloom" },
        { "group": "12. Seasonal", "value": "summer", "label": "Summer Vibes" },
        { "group": "12. Seasonal", "value": "autumn", "label": "Autumn Leaves" },
        { "group": "12. Seasonal", "value": "winter", "label": "Winter Snow" },

        { "group": "13. Utility / Legacy", "value": "hot-key", "label": "Hot-Key Center" },
        { "group": "13. Utility / Legacy", "value": "stepper", "label": "The Stepper" },
        { "group": "13. Utility / Legacy", "value": "side-fan", "label": "Side Fan" },
        { "group": "13. Utility / Legacy", "value": "border-top", "label": "Simple Border Top" },
        { "group": "13. Utility / Legacy", "value": "grid", "label": "Grid Layout" },
        { "group": "13. Utility / Legacy", "value": "socialite", "label": "Socialite" }
      ],
      "default": "ios"
    },
    {
      "type": "header",
      "content": "Menu Content"
    },
    {
      "type": "link_list",
      "id": "menu_source",
      "label": "Select Menu",
      "default": "main-menu"
    },
    {
      "type": "text",
      "id": "icon_mapping",
      "label": "Icon Names",
      "default": "home-5, search, shopping-bag-3, user, customer-service",
      "info": "Comma separated. Use 'history' to trigger recent views."
    },
    {
      "type": "text",
      "id": "custom_labels",
      "label": "Custom Labels",
      "info": "Use 'History' or 'Recent' to trigger drawer."
    },
    {
      "type": "text",
      "id": "url_overrides",
      "label": "Link Overrides"
    },
    {
      "type": "checkbox",
      "id": "show_labels",
      "label": "Show Labels",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "show_cart_count",
      "label": "Show Cart Badge",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_auto_dark",
      "label": "Auto Dark Mode",
      "default": true
    },
    {
      "type": "header",
      "content": "Sizing & Behavior"
    },
    {
      "type": "select",
      "id": "visibility_scope",
      "label": "Device Visibility",
      "options": [
        { "value": "mobile", "label": "Mobile Only" },
        { "value": "mobile_tablet", "label": "Mobile & Tablet" },
        { "value": "all", "label": "All Devices" }
      ],
      "default": "mobile_tablet"
    },
    {
      "type": "range",
      "id": "icon_size",
      "min": 16,
      "max": 40,
      "step": 1,
      "unit": "px",
      "label": "Icon Size",
      "default": 24
    },
    {
      "type": "range",
      "id": "text_size",
      "min": 8,
      "max": 14,
      "step": 1,
      "unit": "px",
      "label": "Label Size",
      "default": 10
    },
    {
      "type": "range",
      "id": "menu_width",
      "min": 50,
      "max": 100,
      "step": 1,
      "unit": "%",
      "label": "Bar Width",
      "default": 95
    },
    {
      "type": "range",
      "id": "spacing_bottom",
      "min": 0,
      "max": 100,
      "step": 2,
      "unit": "px",
      "label": "Bottom Spacing",
      "default": 20
    },
    {
      "type": "range",
      "id": "desktop_width",
      "min": 400,
      "max": 1200,
      "step": 50,
      "unit": "px",
      "label": "Desktop Max Width",
      "default": 600
    },
    {
      "type": "select",
      "id": "desktop_scale",
      "label": "Desktop Scale",
      "options": [
        { "value": "1.0", "label": "100%" },
        { "value": "1.1", "label": "110%" },
        { "value": "1.2", "label": "120%" },
        { "value": "1.3", "label": "130%" }
      ],
      "default": "1.0"
    },
    {
      "type": "checkbox",
      "id": "enable_spacer",
      "label": "Push Content Up",
      "default": false
    },
    {
      "type": "checkbox",
      "id": "enable_draggable",
      "label": "Allow Drag & Rotate",
      "default": false
    },
    {
      "type": "header",
      "content": "Advanced"
    },
    {
      "type": "text",
      "id": "custom_search_selector",
      "label": "Search Selector"
    },
    {
      "type": "text",
      "id": "custom_menu_selector",
      "label": "Menu Selector"
    }
  ]
}
{% endschema %}